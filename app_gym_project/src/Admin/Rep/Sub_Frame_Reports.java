/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package Admin.Rep;

import Class_Files.DB;
import com.toedter.calendar.JTextFieldDateEditor;
import java.sql.ResultSet;
import java.util.Calendar;
import java.util.Vector;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;

/**
 *
 * @author Buwaneka
 */
public class Sub_Frame_Reports extends javax.swing.JPanel {

    double Income;
    double expen;
    double profit;

    /**
     * Creates new form Sub_Frame_Reports
     */
    public Sub_Frame_Reports() {
        initComponents();
        date();
        jButton5_Search.setEnabled(false);
        jButton5_print.setEnabled(false);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jLabel16 = new javax.swing.JLabel();
        jDateChooser1 = new com.toedter.calendar.JDateChooser();
        Label_Ex_count = new javax.swing.JLabel();
        jDateChooser2 = new com.toedter.calendar.JDateChooser();
        jButton5_ClearAll = new javax.swing.JButton();
        jComboBox1 = new javax.swing.JComboBox();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTable1 = new javax.swing.JTable();
        jLabel18 = new javax.swing.JLabel();
        jLabel20 = new javax.swing.JLabel();
        jLabel21 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        jLabel11 = new javax.swing.JLabel();
        jLabel12 = new javax.swing.JLabel();
        jButton5_Search = new javax.swing.JButton();
        Label_Income = new javax.swing.JLabel();
        Label_Expen = new javax.swing.JLabel();
        jLabel19 = new javax.swing.JLabel();
        jLabel22 = new javax.swing.JLabel();
        jLabel23 = new javax.swing.JLabel();
        Label_Prof = new javax.swing.JLabel();
        Label_In_count = new javax.swing.JLabel();
        jLabel1 = new javax.swing.JLabel();
        jButton5_print = new javax.swing.JButton();

        jPanel1.setBackground(new java.awt.Color(255, 255, 255));
        jPanel1.setLayout(null);

        jLabel16.setFont(new java.awt.Font("Segoe UI Semilight", 0, 15)); // NOI18N
        jLabel16.setForeground(new java.awt.Color(51, 51, 51));
        jLabel16.setText("To :");
        jPanel1.add(jLabel16);
        jLabel16.setBounds(360, 50, 40, 30);

        jDateChooser1.setDateFormatString("yyyy-MM-dd");
        jDateChooser1.setFont(new java.awt.Font("Segoe UI Semilight", 0, 15)); // NOI18N
        jDateChooser1.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                jDateChooser1PropertyChange(evt);
            }
        });
        jPanel1.add(jDateChooser1);
        jDateChooser1.setBounds(90, 50, 240, 30);

        Label_Ex_count.setFont(new java.awt.Font("Segoe UI Semilight", 0, 15)); // NOI18N
        Label_Ex_count.setForeground(new java.awt.Color(204, 51, 0));
        Label_Ex_count.setText("0");
        jPanel1.add(Label_Ex_count);
        Label_Ex_count.setBounds(530, 410, 90, 30);

        jDateChooser2.setDateFormatString("yyyy-MM-dd");
        jDateChooser2.setFont(new java.awt.Font("Segoe UI Semilight", 0, 15)); // NOI18N
        jDateChooser2.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                jDateChooser2PropertyChange(evt);
            }
        });
        jPanel1.add(jDateChooser2);
        jDateChooser2.setBounds(390, 50, 240, 30);

        jButton5_ClearAll.setFont(new java.awt.Font("Segoe UI Semilight", 0, 15)); // NOI18N
        jButton5_ClearAll.setText("Clear All");
        jButton5_ClearAll.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton5_ClearAllActionPerformed(evt);
            }
        });
        jPanel1.add(jButton5_ClearAll);
        jButton5_ClearAll.setBounds(850, 420, 160, 30);

        jComboBox1.setFont(new java.awt.Font("Segoe UI Semilight", 0, 15)); // NOI18N
        jComboBox1.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "All", "Income", "Expense" }));
        jComboBox1.setFocusable(false);
        jPanel1.add(jComboBox1);
        jComboBox1.setBounds(690, 50, 260, 30);

        jTable1.setFont(new java.awt.Font("Segoe UI Semilight", 0, 14)); // NOI18N
        jTable1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Date", "Cash Type", "Description", "Ammount", "Added By"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jScrollPane1.setViewportView(jTable1);
        if (jTable1.getColumnModel().getColumnCount() > 0) {
            jTable1.getColumnModel().getColumn(0).setResizable(false);
            jTable1.getColumnModel().getColumn(1).setResizable(false);
            jTable1.getColumnModel().getColumn(1).setPreferredWidth(40);
            jTable1.getColumnModel().getColumn(2).setResizable(false);
            jTable1.getColumnModel().getColumn(2).setPreferredWidth(150);
            jTable1.getColumnModel().getColumn(3).setResizable(false);
            jTable1.getColumnModel().getColumn(4).setResizable(false);
        }

        jPanel1.add(jScrollPane1);
        jScrollPane1.setBounds(30, 140, 980, 220);

        jLabel18.setFont(new java.awt.Font("Segoe UI Semilight", 0, 15)); // NOI18N
        jLabel18.setForeground(new java.awt.Color(51, 51, 51));
        jLabel18.setText("Date :");
        jPanel1.add(jLabel18);
        jLabel18.setBounds(30, 50, 90, 30);

        jLabel20.setFont(new java.awt.Font("Segoe UI Semilight", 0, 15)); // NOI18N
        jLabel20.setForeground(new java.awt.Color(51, 51, 51));
        jLabel20.setText("Total Expense Count :");
        jPanel1.add(jLabel20);
        jLabel20.setBounds(380, 410, 150, 30);

        jLabel21.setFont(new java.awt.Font("Segoe UI Semilight", 0, 15)); // NOI18N
        jLabel21.setForeground(new java.awt.Color(51, 51, 51));
        jLabel21.setText("Total Income Count :");
        jPanel1.add(jLabel21);
        jLabel21.setBounds(380, 370, 140, 30);

        jLabel10.setFont(new java.awt.Font("Segoe UI Semilight", 0, 15)); // NOI18N
        jLabel10.setForeground(new java.awt.Color(51, 51, 51));
        jLabel10.setText("Rs :");
        jPanel1.add(jLabel10);
        jLabel10.setBounds(170, 370, 30, 30);

        jLabel11.setFont(new java.awt.Font("Segoe UI Semilight", 0, 15)); // NOI18N
        jLabel11.setForeground(new java.awt.Color(51, 51, 51));
        jLabel11.setText("Rs :");
        jPanel1.add(jLabel11);
        jLabel11.setBounds(170, 410, 30, 30);

        jLabel12.setFont(new java.awt.Font("Segoe UI Semilight", 0, 15)); // NOI18N
        jLabel12.setForeground(new java.awt.Color(51, 51, 51));
        jLabel12.setText("Rs :");
        jPanel1.add(jLabel12);
        jLabel12.setBounds(170, 450, 30, 30);

        jButton5_Search.setFont(new java.awt.Font("Segoe UI Semilight", 0, 15)); // NOI18N
        jButton5_Search.setText("Search");
        jButton5_Search.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton5_SearchActionPerformed(evt);
            }
        });
        jPanel1.add(jButton5_Search);
        jButton5_Search.setBounds(860, 100, 160, 30);

        Label_Income.setFont(new java.awt.Font("Segoe UI Semilight", 0, 15)); // NOI18N
        Label_Income.setForeground(new java.awt.Color(0, 153, 153));
        Label_Income.setText("0");
        jPanel1.add(Label_Income);
        Label_Income.setBounds(200, 370, 160, 30);

        Label_Expen.setFont(new java.awt.Font("Segoe UI Semilight", 0, 15)); // NOI18N
        Label_Expen.setForeground(new java.awt.Color(204, 51, 0));
        Label_Expen.setText("0");
        jPanel1.add(Label_Expen);
        Label_Expen.setBounds(200, 410, 160, 30);

        jLabel19.setFont(new java.awt.Font("Segoe UI Semilight", 0, 15)); // NOI18N
        jLabel19.setForeground(new java.awt.Color(51, 51, 51));
        jLabel19.setText("Profit :");
        jPanel1.add(jLabel19);
        jLabel19.setBounds(50, 450, 70, 30);

        jLabel22.setFont(new java.awt.Font("Segoe UI Semilight", 0, 15)); // NOI18N
        jLabel22.setForeground(new java.awt.Color(51, 51, 51));
        jLabel22.setText("Total Income :");
        jPanel1.add(jLabel22);
        jLabel22.setBounds(50, 370, 110, 30);

        jLabel23.setFont(new java.awt.Font("Segoe UI Semilight", 0, 15)); // NOI18N
        jLabel23.setForeground(new java.awt.Color(51, 51, 51));
        jLabel23.setText("Total Expense :");
        jPanel1.add(jLabel23);
        jLabel23.setBounds(50, 410, 120, 30);

        Label_Prof.setFont(new java.awt.Font("Segoe UI Semilight", 0, 15)); // NOI18N
        Label_Prof.setForeground(new java.awt.Color(0, 153, 0));
        Label_Prof.setText("0");
        jPanel1.add(Label_Prof);
        Label_Prof.setBounds(200, 450, 180, 30);

        Label_In_count.setFont(new java.awt.Font("Segoe UI Semilight", 0, 15)); // NOI18N
        Label_In_count.setForeground(new java.awt.Color(0, 153, 153));
        Label_In_count.setText("0");
        jPanel1.add(Label_In_count);
        Label_In_count.setBounds(530, 370, 90, 30);

        jLabel1.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        jPanel1.add(jLabel1);
        jLabel1.setBounds(40, 450, 340, 30);

        jButton5_print.setFont(new java.awt.Font("Segoe UI Semilight", 0, 15)); // NOI18N
        jButton5_print.setText("Print Report");
        jButton5_print.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton5_printActionPerformed(evt);
            }
        });
        jPanel1.add(jButton5_print);
        jButton5_print.setBounds(850, 380, 160, 30);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 1040, javax.swing.GroupLayout.PREFERRED_SIZE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 530, javax.swing.GroupLayout.PREFERRED_SIZE)
        );
    }// </editor-fold>//GEN-END:initComponents

    private void jDateChooser1PropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_jDateChooser1PropertyChange

        try {

            int a = jDateChooser1.getDate().toString().length();
            int b = jDateChooser2.getDate().toString().length();

            if (a == 0) {
                jButton5_Search.setEnabled(false);
            } else {
                if (a != 0 && b != 0) {
                    jButton5_Search.setEnabled(true);
                }
            }

        } catch (NullPointerException e) {
        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_jDateChooser1PropertyChange

    private void jDateChooser2PropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_jDateChooser2PropertyChange

        try {

            int a = jDateChooser1.getDate().toString().length();
            int b = jDateChooser2.getDate().toString().length();

            if (b == 0) {
                jButton5_Search.setEnabled(false);
            } else {
                if (a != 0 && b != 0) {
                    jButton5_Search.setEnabled(true);
                }
            }

        } catch (NullPointerException e) {
        } catch (Exception e) {
            e.printStackTrace();
        }

    }//GEN-LAST:event_jDateChooser2PropertyChange

    private void jButton5_ClearAllActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton5_ClearAllActionPerformed

        try {

            DefaultTableModel dtm = (DefaultTableModel) jTable1.getModel();
            dtm.setRowCount(0);
            jDateChooser1.setDate(null);
            jDateChooser2.setDate(null);
            Label_Income.setText("0");
            Label_Expen.setText("0");
            Label_Prof.setText("0");
            Label_Ex_count.setText("0");
            Label_In_count.setText("0");
            jButton5_print.setEnabled(false);
            jButton5_Search.setEnabled(false);

        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_jButton5_ClearAllActionPerformed

    String date;
    String date1;
    long Start_date;
    long End_date;

    String X;
    String Y;

    private void jButton5_SearchActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton5_SearchActionPerformed

        try {
            Calendar ca = jDateChooser1.getCalendar();
            int Year = ca.get(Calendar.YEAR);
            int Month = ca.get(Calendar.MONTH);
            Month++;
            int Day = ca.get(Calendar.DATE);

            date = Year + "-" + Month + "-" + Day;

            String s1[] = date.split("-");

            if (Integer.parseInt(s1[1]) < 10) {
                s1[1] = "0" + s1[1];
            }
            if (Integer.parseInt(s1[2]) < 10) {
                s1[2] = "0" + s1[2];
            }

            String cd1 = s1[0] + "" + s1[1] + "" + s1[2];
            X = s1[0] + "-" + s1[1] + "-" + s1[2];
            Start_date = Long.parseLong(cd1);

//_________________________________________________________________________//
            Calendar ca1 = jDateChooser2.getCalendar();
            int Year1 = ca1.get(Calendar.YEAR);
            int Month1 = ca1.get(Calendar.MONTH);
            Month1++;
            int Day1 = ca1.get(Calendar.DATE);

            date1 = Year1 + "-" + Month1 + "-" + Day1;

            String s2[] = date1.split("-");

            if (Integer.parseInt(s2[1]) < 10) {
                s2[1] = "0" + s2[1];
            }
            if (Integer.parseInt(s2[2]) < 10) {
                s2[2] = "0" + s2[2];
            }

            String cd2 = s2[0] + "" + s2[1] + "" + s2[2];
            Y = s2[0] + "-" + s2[1] + "-" + s2[2];

            End_date = Long.parseLong(cd2);

            /*Check Datechooser1 date < Datechooser2 Date*/
            if (Start_date > End_date) {
                JOptionPane.showMessageDialog(this, "Please check the date Range.!");
            } else {
                String type = jComboBox1.getSelectedItem().toString();
                Search(X, Y, type);

            }

        } catch (NullPointerException n) {
        } catch (Exception e) {
            e.printStackTrace();
        }

    }//GEN-LAST:event_jButton5_SearchActionPerformed

    private void jButton5_printActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton5_printActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jButton5_printActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JLabel Label_Ex_count;
    private javax.swing.JLabel Label_Expen;
    private javax.swing.JLabel Label_In_count;
    private javax.swing.JLabel Label_Income;
    private javax.swing.JLabel Label_Prof;
    private javax.swing.JButton jButton5_ClearAll;
    private javax.swing.JButton jButton5_Search;
    private javax.swing.JButton jButton5_print;
    private javax.swing.JComboBox jComboBox1;
    private com.toedter.calendar.JDateChooser jDateChooser1;
    private com.toedter.calendar.JDateChooser jDateChooser2;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel21;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel23;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTable jTable1;
    // End of variables declaration//GEN-END:variables

    public void date() {

        //JDateChooser chooser = new JDateChooser();
        JTextFieldDateEditor editor = (JTextFieldDateEditor) jDateChooser1.getDateEditor();
        editor.setEditable(false);

        JTextFieldDateEditor editor1 = (JTextFieldDateEditor) jDateChooser2.getDateEditor();
        editor1.setEditable(false);

    }

    int cashid;

    private void Search(String X, String Y, String Type) {

        try {

            System.gc();
            if (Type.equals("All")) {
                //if ALL;
                byte i = 0;
                int z = 0;
                int y = 0;

                ResultSet rs = DB.search("SELECT * FROM cash_account WHERE  Cash_date >= '" + X + "' AND Cash_date   <= '" + Y + "'");
                DefaultTableModel dtm = (DefaultTableModel) jTable1.getModel();
                dtm.setRowCount(0);
                while (rs.next()) {
                    i = 1;
                    Vector v = new Vector();
                    cashid = rs.getInt("Cash_acc_Id");
                    v.add(rs.getString("Cash_date"));
                    v.add(rs.getString("Cash_type"));
                    v.add(rs.getString("Descrip"));
                    v.add(rs.getString("Ammount"));

                    if (rs.getString("Cash_type").equals("Income")) {
                        ++z;
                    } else {
                        ++y;

                    }

                    ResultSet rs2 = DB.search("SELECT * FROM user_account WHERE Acount_Id = '" + rs.getString("Acount_Id") + "' ");
                    while (rs2.next()) {
                        v.add(rs2.getString("Name"));
                    }

                    dtm.addRow(v);

                }

                Label_In_count.setText(z + "");
                Label_Ex_count.setText(y + "");
////////////////////
                //Income
                ResultSet rs3 = DB.search("SELECT SUM(Ammount) as total_mark FROM cash_account WHERE  Cash_date >= '" + X + "' AND Cash_date   <= '" + Y + "' AND Cash_type = '" + "Income" + "' ");
                while (rs3.next()) {
                    Income = Double.parseDouble(rs3.getString(1));
                    Label_Income.setText(rs3.getDouble(1) + "0");

                }

///Exp
                ResultSet rs4 = DB.search("SELECT SUM(Ammount) as total_mark FROM cash_account WHERE  Cash_date >= '" + X + "' AND Cash_date   <= '" + Y + "' AND Cash_type = '" + "Expense" + "' ");
                while (rs4.next()) {
                    expen = Double.parseDouble(rs4.getString(1));
                    Label_Expen.setText(rs4.getDouble(1) + "0");
                }

                Label_Prof.setText(Income - expen + "0");

//No results Available;
                if (i == 0) {
                    JOptionPane.showMessageDialog(this, "Sorry No result found..!");
                    DefaultTableModel dtm3 = (DefaultTableModel) jTable1.getModel();
                    dtm3.setRowCount(0);

                }
////////////////////////////////////////////////////////////////////////////////////////////
            } else if (Type.equals("Income")) {
                //If Type is Income

                Label_Income.setText("0");
                Label_Expen.setText("0");
                Label_Prof.setText("0");

                Label_Ex_count.setText("0");
                Label_In_count.setText("0");

                byte i = 0;
                int x = 0;
                ResultSet rs = DB.search("SELECT * FROM cash_account WHERE  Cash_date >= '" + X + "' AND Cash_date   <= '" + Y + "' AND Cash_type = '" + "Income" + "' ");
                DefaultTableModel dtm = (DefaultTableModel) jTable1.getModel();
                dtm.setRowCount(0);
                while (rs.next()) {
                    i = 1;
                    ++x;
                    Vector v = new Vector();
                    cashid = rs.getInt("Cash_acc_Id");
                    v.add(rs.getString("Cash_date"));
                    v.add(rs.getString("Cash_type"));
                    v.add(rs.getString("Descrip"));
                    v.add(rs.getString("Ammount"));

                    ResultSet rs2 = DB.search("SELECT * FROM user_account WHERE Acount_Id = '" + rs.getString("Acount_Id") + "' ");
                    while (rs2.next()) {
                        v.add(rs2.getString("Name"));
                    }

                    dtm.addRow(v);

                    ResultSet rs3 = DB.search("SELECT SUM(Ammount) as total_mark FROM cash_account WHERE  Cash_date >= '" + X + "' AND Cash_date   <= '" + Y + "' AND Cash_type = '" + "Income" + "' ");
                    while (rs3.next()) {
                        Income = Double.parseDouble(rs3.getString(1));
                        Label_Income.setText(rs3.getDouble(1) + "0");
                    }

                }
                Label_In_count.setText(x + "");
                //No results Available;
                if (i == 0) {
                    JOptionPane.showMessageDialog(this, "Sorry No result found..!");
                    DefaultTableModel dtm3 = (DefaultTableModel) jTable1.getModel();
                    dtm3.setRowCount(0);
                }
///////////////////////////////////////////////////////////////////
            } else {

                Label_Income.setText("0");
                Label_Expen.setText("0");
                Label_Prof.setText("0");

                Label_Ex_count.setText("0");
                Label_In_count.setText("0");

                //Else Type is Expence
                byte i = 0;
                int y = 0;
                ResultSet rs = DB.search("SELECT * FROM cash_account WHERE  Cash_date >= '" + X + "' AND Cash_date   <= '" + Y + "' AND Cash_type = '" + "Expense" + "' ");
                DefaultTableModel dtm = (DefaultTableModel) jTable1.getModel();
                dtm.setRowCount(0);
                while (rs.next()) {
                    i = 1;
                    ++y;
                    Vector v = new Vector();
                    cashid = rs.getInt("Cash_acc_Id");
                    v.add(rs.getString("Cash_date"));
                    v.add(rs.getString("Cash_type"));
                    v.add(rs.getString("Descrip"));
                    v.add(rs.getString("Ammount"));

                    ResultSet rs2 = DB.search("SELECT * FROM user_account WHERE Acount_Id = '" + rs.getString("Acount_Id") + "' ");
                    while (rs2.next()) {
                        v.add(rs2.getString("Name"));
                    }

                    dtm.addRow(v);

                    ResultSet rs4 = DB.search("SELECT SUM(Ammount) as total_mark FROM cash_account WHERE  Cash_date >= '" + X + "' AND Cash_date   <= '" + Y + "' AND Cash_type = '" + "Expense" + "' ");
                    while (rs4.next()) {
                        expen = Double.parseDouble(rs4.getString(1));
                        Label_Expen.setText(rs4.getDouble(1) + "0");
                    }
                    Label_Ex_count.setText(y + "");

                }
                //No results Available;
                if (i == 0) {
                    JOptionPane.showMessageDialog(this, "Sorry No result found..!");
                    DefaultTableModel dtm3 = (DefaultTableModel) jTable1.getModel();
                    dtm3.setRowCount(0);
                }

            }

        } catch (NullPointerException n) {
          
        }catch (Exception e) {
            e.printStackTrace();
        }

    }

}
